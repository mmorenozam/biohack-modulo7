<!DOCTYPE html>
<html lang="es"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/quarto-contrib/quarto-timer-1.0.0/timer.js"></script>
<link href="site_libs/quarto-contrib/quarto-timer-1.0.0/timer.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <title>biohack-modulo7 – biohack-modulo7</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

  <script src="site_libs/tabwid-1.1.3/tabwid.js"></script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:37.5%;">
<p><img data-src="images/icon1_nb.png" style="margin-left:-50px"></p>
</div><div class="column" style="width:60%;">
<div class="title" data-id="title">
<p>Módulo 7: Otros métodos estadísticos</p>
</div>
<p>Mauricio Moreno, PhD</p>
</div></div>
<p><img data-src="images/nathana-reboucas-AGLTICzftCc-unsplash.jpg" class="image-left"></p>
</section>
<section>
<section id="antes-de-comenzar" class="title-slide slide level1 center">
<h1>Antes de comenzar</h1>

</section>
<section id="mapas-de-calor-con-ggplot2" class="slide level2">
<h2>Mapas de calor con <code>{ggplot2}</code>!</h2>
<div>
<ul>
<li class="fragment"><p>Hace poco descubrí un nuevo paquete que nos ayuda a realizar mapas de calor con <code>{ggplot2}</code></p></li>
<li class="fragment"><p>Su nombre es <code>{tidyheatmaps}</code> y puedes ver acerca del mismo <a href="https://stemangiola.github.io/tidyHeatmap/" target="_blank">aquí</a></p></li>
</ul>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyheatmaps)</span>
<span id="cb1-2"><a></a><span class="fu">tidyheatmap</span>(data_exprs,</span>
<span id="cb1-3"><a></a>            <span class="at">rows =</span> external_gene_name,</span>
<span id="cb1-4"><a></a>            <span class="at">columns =</span> sample,</span>
<span id="cb1-5"><a></a>            <span class="at">values =</span> expression,</span>
<span id="cb1-6"><a></a>            <span class="at">scale =</span> <span class="st">"row"</span>,</span>
<span id="cb1-7"><a></a>            <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-8"><a></a>            <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-9"><a></a>            <span class="at">display_numbers =</span> <span class="cn">TRUE</span></span>
<span id="cb1-10"><a></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="heterocedasticidad-en-el-anova" class="slide level2 smaller">
<h2>Heterocedasticidad en el ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>Usaremos los datos de las ranas arbóreas de ojos rojos de Touchon (disponibles en formato csv en la pestaña de recursos del sition web del curso).</p></li>
<li class="fragment"><p>Estos corresponden a una investigación que llevo por objetivo el estudiar las interacciones entre predadores y recursos en el desarrollo de estas ranas desde su eclosión hasta el término de la metamorfosis.</p></li>
<li class="fragment"><p>Nos enfocaremos en las variables:</p>
<ul>
<li class="fragment"><p>Respuesta: Edad de metamorfosis (<code>Age.DPO</code>)</p></li>
<li class="fragment"><p>Independientes:</p>
<ul>
<li class="fragment"><p>Predadores (<code>Pred</code>), 3 niveles: <strong>L</strong> = letales, <strong>NL</strong> = no letales y <strong>C</strong> = control</p></li>
<li class="fragment"><p>Recursos (<code>Res</code>), 2 niveles: <strong>Lo</strong> = bajos y <strong>Hi</strong> = altos</p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>El diseño experimental cae en la categoría de un DFC en bloques.</p></li>
<li class="fragment"><p>La pregunta de investigación en esta caso particular, es el determinar si la edad del término de la metaformosis se ve afectada por la presencia/ausencia de depredadores y abundancia/carencia de recursos.</p></li>
</ul>
</div>
</section>
<section id="heterocedasticidad-en-el-anova-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Heterocedasticidad en el ANOVA</h2>
<ul>
<li>Para ahorrarnos tiempo, supongamos que ya corrimos un primer ANOVA no aditivo de dos vías, y encontramos desviaciones de la normalidad que corregimos con la transformación del logaritmo de <code>Age.DPO</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">library</span>(car)</span>
<span id="cb2-2"><a></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/touchon.csv"</span>)</span>
<span id="cb2-3"><a></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> Pred <span class="sc">*</span> Res, <span class="at">data =</span> ranas)</span>
<span id="cb2-4"><a></a>residuos <span class="ot">&lt;-</span> lm<span class="sc">$</span>residuals</span>
<span id="cb2-5"><a></a><span class="fu">shapiro.test</span>(residuos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuos
W = 0.98939, p-value = 0.7702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="fu">leveneTest</span>(lm)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value    Pr(&gt;F)    
group  5  4.6455 0.0009903 ***
      72                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Como podemos ver, la normalidad de los residuos ya no es un problema, pero la homogeinidad de varianzas si lo es.</li>
</ul>
</div>
</section>
<section id="corrección-de-welch-en-anova" class="slide level2 smaller">
<h2>Corrección de Welch en ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>En ANOVA, de manera similar a las pruebas t, es posible usar la corrección de Welch para cuando el supuesto de la heterodasticidad no se cumple.</p></li>
<li class="fragment"><p>La desventaja radica en que este test solo es aplicable en la estructura del ANOVA de una vía</p></li>
<li class="fragment"><p>Esto no es un problema si sabemos re-parametrizar el ANOVA de dos vías original.</p></li>
</ul>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Colapsamos los factores un único factor</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>ranas<span class="sc">$</span>log.Age.DPO <span class="ot">&lt;-</span> <span class="fu">log</span>(ranas<span class="sc">$</span>Age.DPO)</span>
<span id="cb6-2"><a></a>ranas<span class="sc">$</span>tratamiento <span class="ot">&lt;-</span> <span class="fu">paste</span>(ranas<span class="sc">$</span>Pred, ranas<span class="sc">$</span>Res, <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<ul>
<li>La corrección de Welch para ANOVA está disponible en el paquete <code>{rstatix}</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">library</span>(rstatix)</span>
<span id="cb7-2"><a></a>anova_welch <span class="ot">&lt;-</span> ranas <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a></a>  <span class="fu">welch_anova_test</span>(log.Age.DPO <span class="sc">~</span> tratamiento)</span>
<span id="cb7-4"><a></a>anova_welch</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.             n statistic   DFn   DFd           p method     
* &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      
1 log.Age.DPO    78      17.2     5  24.0 0.000000305 Welch ANOVA</code></pre>
</div>
</div>
</div></div>
</div>
</section>
<section id="corrección-de-welch-en-anova-1" class="slide level2 smaller">
<h2>Corrección de Welch en ANOVA</h2>
<ul>
<li>Otra desventaja es el no contar más con las agrupaciones por letras de las comparaciones múltiples</li>
</ul>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>comparaciones <span class="ot">&lt;-</span> ranas <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a></a>  <span class="fu">games_howell_test</span>(log.Age.DPO <span class="sc">~</span> tratamiento)</span>
<span id="cb9-3"><a></a>comparaciones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 8
   .y.         group1 group2 estimate conf.low conf.high      p.adj p.adj.signif
 * &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
 1 log.Age.DPO C-Hi   C-Lo    0.440     0.180     0.700  0.000261   ***         
 2 log.Age.DPO C-Hi   L-Hi   -0.202    -0.362    -0.0425 0.008      **          
 3 log.Age.DPO C-Hi   L-Lo   -0.0452   -0.258     0.168  0.986      ns          
 4 log.Age.DPO C-Hi   NL-Hi  -0.0531   -0.351     0.244  0.988      ns          
 5 log.Age.DPO C-Hi   NL-Lo   0.285    -0.331     0.902  0.545      ns          
 6 log.Age.DPO C-Lo   L-Hi   -0.643    -0.877    -0.408  0.00000114 ****        
 7 log.Age.DPO C-Lo   L-Lo   -0.485    -0.754    -0.217  0.0000932  ****        
 8 log.Age.DPO C-Lo   NL-Hi  -0.493    -0.821    -0.166  0.002      **          
 9 log.Age.DPO C-Lo   NL-Lo  -0.155    -0.772     0.462  0.936      ns          
10 log.Age.DPO L-Hi   L-Lo    0.157    -0.0196    0.334  0.099      ns          
11 log.Age.DPO L-Hi   NL-Hi   0.149    -0.142     0.440  0.448      ns          
12 log.Age.DPO L-Hi   NL-Lo   0.488    -0.133     1.11   0.129      ns          
13 log.Age.DPO L-Lo   NL-Hi  -0.00797  -0.310     0.294  1          ns          
14 log.Age.DPO L-Lo   NL-Lo   0.331    -0.286     0.947  0.419      ns          
15 log.Age.DPO NL-Hi  NL-Lo   0.339    -0.284     0.961  0.433      ns          </code></pre>
</div>
</div>
</div></div>
</section>
<section id="corrección-de-welch-en-anova-2" class="slide level2 smaller">
<h2>Corrección de Welch en ANOVA</h2>
<ul>
<li>Pero podemos llevar a cabo gráficos de comparaciones por pares con la ayuda de <code>{ggpubr}</code></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb11-2"><a></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-3"><a></a><span class="fu">ggboxplot</span>(ranas, </span>
<span id="cb11-4"><a></a>          <span class="at">x =</span> <span class="st">"tratamiento"</span>, </span>
<span id="cb11-5"><a></a>          <span class="at">y =</span> <span class="st">"log.Age.DPO"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a></a>  <span class="fu">stat_pvalue_manual</span>(comparaciones, </span>
<span id="cb11-7"><a></a>                     <span class="at">label =</span> <span class="st">"p.adj"</span>, </span>
<span id="cb11-8"><a></a>                     <span class="at">y.position =</span> <span class="fu">seq</span>(<span class="fl">5.1</span>, <span class="dv">6</span>, </span>
<span id="cb11-9"><a></a>                                      <span class="at">length.out =</span> <span class="dv">5</span>), </span>
<span id="cb11-10"><a></a>                     <span class="at">hide.ns =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="regresión-lineal" class="title-slide slide level1 center">
<h1>Regresión lineal</h1>

</section>
<section id="generalidades" class="slide level2 smaller">
<h2>Generalidades</h2>
<div>
<ul>
<li class="fragment"><p>Se diferencia del ANOVA al considerar uno o más predictores continuos (no factores categóricos).</p></li>
<li class="fragment"><p>Los supuestos de la regresión lineal son:</p>
<ul>
<li class="fragment"><p>Existencia de una relación lineal entre las variables continuas objeto de la regresión</p></li>
<li class="fragment"><p>Normalidad de los residuos</p></li>
<li class="fragment"><p>Que no exista multicolinearidad (en el caso de regresión múltiple)</p></li>
<li class="fragment"><p>Que no exista auto correlación (que las observaciones no dependan una de otra dentro de una misma variable)</p></li>
<li class="fragment"><p>Homogeneidad de la varianza de los residuos</p></li>
</ul></li>
<li class="fragment"><p>Contrario al ANOVA, no existen correcciones o métodos alternativos cuando las transformaciones fallan.</p></li>
<li class="fragment"><p>Por esto, lo que se recomienda hacer es mencionar todos los detalles de la conducción del modelo.</p></li>
<li class="fragment"><p>En regresión lineal es quizá en el método que más se abusa del remover outliers.</p></li>
</ul>
</div>
</section>
<section id="regresión-lineal-simple-en-r" class="slide level2 smaller">
<h2>Regresión lineal simple en R</h2>
<div>
<ul>
<li class="fragment"><p>Usando los datos de Touchon, podríamos preguntarnos si el tamaño de las ranas al final de la metamorfosis <code>SVL.final</code> está influenciado por la edad en finalizar la metamorfosis <code>Age.DPO</code>.</p></li>
<li class="fragment"><p>Esta regresión lineal sería de la siguiente forma:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SVL.final <span class="sc">~</span> Age.DPO, <span class="at">data =</span> ranas)</span>
<span id="cb12-2"><a></a><span class="fu">summary</span>(reg1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SVL.final ~ Age.DPO, data = ranas)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1414 -0.9521 -0.1297  0.6842  3.4349 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 21.285436   0.416763  51.073  &lt; 2e-16 ***
Age.DPO     -0.029437   0.006052  -4.864 6.08e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.262 on 76 degrees of freedom
Multiple R-squared:  0.2374,    Adjusted R-squared:  0.2273 
F-statistic: 23.65 on 1 and 76 DF,  p-value: 6.081e-06</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Pero antes de cualquier inferencia, vamos a darle un vistazo a los diagnósticos de la regresión lineal</li>
</ul>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal" class="slide level2">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb14-2"><a></a><span class="fu">plot</span>(reg1)</span>
<span id="cb14-3"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-1" class="slide level2" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center r-stretch" width="576"></section>
<section id="diagnósticos-de-la-regresión-lineal-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-13-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Valores ajustados</strong></p>
<p>En el ANOVA vimos como este plot sugería departuras de la homocedasticidad. En el caso de la regresión lineal, los residuos al no estar agrupados en categorías presentan mayor información sobre este supuesto. Adicionalmente, curvaturas en la línea roja evidencian también departuras de la linearidad. Esto quiere decir que la relación entre las variables no es completamente lineal. A veces esto puede corregirse con transformaciones.</p>
</div></div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-3" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>

<img data-src="images/kutner.png" class="quarto-figure quarto-figure-center r-stretch"><ol type="a">
<li>Es ideal. (b) Es indicativo de no linearidad. (c) Evidencia de heterocedasticidad. (d) Evidencia de una tendencia temporal</li>
</ol>
</section>
<section id="diagnósticos-de-la-regresión-lineal-4" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-14-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Apalancamiento</strong></p>
<p>Aquellos puntos que estén etiquetados con números son mostrados como posibles outliers bajo dos criterios:</p>
<ul>
<li><p>Están por fuera de los límites de la regla del rango intercuartílico (IQR), y</p></li>
<li><p>Marcados como outliers con influencia de apalancamiento mediante la prueba de Cook (distancia de Cook).</p></li>
</ul>
<p>El segundo criterio es un argumento sólido para remover outliers.</p>
</div></div>
</section>
<section id="pruebas-formales-de-los-supuestos" class="slide level2 smaller">
<h2>Pruebas formales de los supuestos</h2>
<div>
<ul>
<li class="fragment"><p>Como vimos, los supuestos de la regresión lineal son más que para el ANOVA.</p></li>
<li class="fragment"><p>Existen varias pruebas formales para chequear cada uno de sus supuestos, sin embargo rara vez son empleadas.</p></li>
<li class="fragment"><p>La razón yace en que si los aplicáramos todo el tiempo, no haríamos regresiones lineales ni el 10% de las veces.</p></li>
<li class="fragment"><p>Si tienes curiosidad en estas pruebas puedes visitar <a href="https://rpubs.com/aryn999/LinearRegressionAssumptionsAndDiagnosticsInR" target="_blank">este enlace.</a></p></li>
<li class="fragment"><p>De alguna manera podemos decir que de hecho, los estadísticos somos más laxos con la regresión lineal siempre y cuando estas departuras de los supuestos fueran debidamente documentadas y plasmadas en los trabajos científicos, lo cual lamentablemente no pasa muy a menudo.</p></li>
<li class="fragment"><p>Existen por supuesto métodos que no dependen de todos estos supuestos (por ejemplo: regresiones lineales Bayesianas, modelos lineales generalizados correctamente parametrizados) pero no son parte de este curso.</p></li>
</ul>
</div>
</section>
<section id="transformación-de-datos" class="slide level2 smaller">
<h2>Transformación de datos</h2>
<div class="columns v-center-container">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SVL.final <span class="sc">~</span> Age.DPO, <span class="at">data =</span> ranas)</span>
<span id="cb15-2"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb15-3"><a></a><span class="fu">plot</span>(reg1)</span>
<span id="cb15-4"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-16-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SVL.final) <span class="sc">~</span> <span class="fu">log</span>(Age.DPO), <span class="at">data =</span> ranas)</span>
<span id="cb16-2"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb16-3"><a></a><span class="fu">plot</span>(reg1)</span>
<span id="cb16-4"><a></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-18-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="interpretación-de-la-regresión-lineal" class="slide level2 smaller scrollable">
<h2>Interpretación de la regresión lineal</h2>
<p><span class="math display">\[
y = mx + b
\]</span></p>
<div class="columns v-center-container">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(SVL.final) ~ log(Age.DPO), data = ranas)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.182298 -0.049070  0.000516  0.038342  0.159057 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.44001    0.09211  37.345  &lt; 2e-16 ***
log(Age.DPO) -0.11624    0.02232  -5.208 1.58e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06244 on 76 degrees of freedom
Multiple R-squared:  0.263, Adjusted R-squared:  0.2533 
F-statistic: 27.12 on 1 and 76 DF,  p-value: 1.581e-06</code></pre>
</div>
</div>
<ul>
<li>Por cada incremento en una unidad del logaritmo de <code>Age.DPO</code>, tenemos 0.12 unidades en descenso del logaritmo de <code>SVL.final</code></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">ggplot</span>(ranas, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Age.DPO), <span class="at">y =</span> <span class="fu">log</span>(SVL.final))) <span class="sc">+</span></span>
<span id="cb18-2"><a></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb18-3"><a></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="interpretación-de-la-regresión-lineal-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Interpretación de la regresión lineal</h2>
<div>
<ul>
<li class="fragment"><p>Sin embargo una interpretación en la escala logarítmica no es completamente entendible, al menos para alguien ajeno al análisis que realizamos.</p></li>
<li class="fragment"><p>Podríamos hacer la retransformación de las variables a sus unidades originales y generar un gráfico de las predicciones. A la final se reduce a matemática básica.</p></li>
<li class="fragment"><p>Afortunadamente la librería <code>{ggeffects}</code> nos puede ayudar</p></li>
</ul>
</div>
<div class="fragment">
<div class="columns v-center-container">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb19-2"><a></a>predicciones <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(reg1)</span>
<span id="cb19-3"><a></a>predicciones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Age.DPO
# Predicted values of SVL.final

Age.DPO | Predicted |       95% CI
----------------------------------
     35 |     20.63 | 20.05, 21.23
     50 |     19.79 | 19.46, 20.13
     60 |     19.38 | 19.11, 19.65
     75 |     18.88 | 18.57, 19.20
     90 |     18.48 | 18.08, 18.90
    105 |     18.16 | 17.66, 18.67
    120 |     17.88 | 17.30, 18.48
    145 |     17.49 | 16.79, 18.22</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
attr(,"class")
[1] "ggalleffects" "list"        
attr(,"model.name")
[1] "reg1"</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">plot</span>(predicciones<span class="sc">$</span>Age.DPO)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-22-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="regresión-lineal-múltiple-en-r" class="slide level2 smaller">
<h2>Regresión lineal múltiple en R</h2>
<div>
<ul>
<li class="fragment"><p>Es usada para predecir una sola variable continua (y) en función de múltiples predictores continuos (un set de variables X).</p></li>
<li class="fragment"><p>Tiene prácticamente los mismos supuestos que la regresión lineal simple:</p>
<ul>
<li class="fragment"><p>Linearidad de los predictores</p></li>
<li class="fragment"><p>Homogeneidad de la varianza (homocedasticidad)</p></li>
<li class="fragment"><p>Independencia de los errores (residuos)</p></li>
<li class="fragment"><p>Normalidad de los residuos</p></li>
<li class="fragment"><p>Independencia de los predictores</p></li>
</ul></li>
<li class="fragment"><p>Un ejemplo de una regresión múltiple podría expresarse mediante la siguiente ecuación</p></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{align}
y &amp;= \beta_0 + \beta_1\,X_1 + \beta_2\,X_2 \dots \beta_n\,X_n
\end{align}\]</span>
</div>
</section>
<section id="pasos-para-una-regresión-múltiple" class="slide level2 smaller">
<h2>Pasos para una regresión múltiple</h2>
<div>
<ul>
<li class="fragment"><p>El llegar a un modelo apropiado se convierte en lo que algunos estadísticos llaman el “arte de modelar”:</p>
<ol type="1">
<li class="fragment"><p>Empezar por lo que se le conoce como un modelo completo (incluyendo todas las variables continuas disponibles).</p></li>
<li class="fragment"><p>Realizar una selección automática de variables sobre el modelo del paso 1.</p></li>
<li class="fragment"><p>Checar manualmente por colinearidad entre las variables del modelo resultante del paso 2.</p></li>
<li class="fragment"><p>Revisar si las variables incluidas tienen sentido (biológico),</p></li>
<li class="fragment"><p>Checar los supuestos de normalidad y homocedasticidad.</p></li>
<li class="fragment"><p>Realizar transformaciones de ser necesario.</p></li>
<li class="fragment"><p>Interpretar resultados.</p></li>
</ol></li>
<li class="fragment"><p>Estos pasos son solo mi recomendación. Dependiendo del problema, quizá ni siquiera sirvan y sus análisis estarán de la mano de más de su buen entendimiento de los datos y los fenómenos que deseen explicar.</p></li>
</ul>
</div>
</section>
<section id="datos-que-usaremos" class="slide level2 smaller">
<h2>Datos que usaremos</h2>
<div>
<ul>
<li class="fragment"><p>Usaremos los datos de rotavirus en Berlin del archivo de Excel “rotXLS.xlsx” que contiene información sobre el conteo de casos de rotavirus en Berlín desde el año 2001 hasta el 2020.</p></li>
<li class="fragment"><p>Supongámos que queremos modelar la variable <code>cases</code> en función de todas las variables metereológicas a nuestra disposición. Para esto, aquí la descripción de esta tabla de datos</p></li>
</ul>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li><p><code>date</code>: fecha de cierre de la toma de datos</p></li>
<li><p><code>cases</code>: número de casos de rotavirus en la semana</p></li>
<li><p><code>week</code>: semana epidemiológica</p></li>
<li><p><code>incidence</code>: número de casos/100000 habitantes</p></li>
<li><p><code>FM</code>: media diaria de velocidad del viento (m/s)</p></li>
<li><p><code>RSK</code>: media diaria de lluvia (mm)</p></li>
</ul>
</div><div class="column fragment" style="width:50%;">
<ul>
<li><p><code>SHK_TAG</code>: media diaria de nieve (cm)</p></li>
<li><p><code>PM</code>: media diaria de presión atmosférica (hPa)</p></li>
<li><p><code>TMK</code>: media diaria de temperatura (°C)</p></li>
<li><p><code>TXK</code>: media diaria de temperatura máxima (°C)</p></li>
<li><p><code>TNK</code>: media diaria de temperatura mínima (°C)</p></li>
<li><p><code>UPM</code>: media diaria de humedad relativa (%)</p></li>
</ul>
</div></div>
<div class="fragment">
<ul>
<li>Sin embargo, antes de continuar, debemos hacer un preprocesamiento de datos ya que en la estructura original de estos se considera un efecto temporal dado por los años. Para simplificarlo, agruparemos los datos por meses y semanas epidemiológicas.</li>
</ul>
</div>
</section>
<section id="preprocesamiento-de-datos" class="slide level2 smaller" data-visibility="uncounted">
<h2>Preprocesamiento de datos</h2>
<ul>
<li>Asegúrate de tener instaladas las librerías <code>{dplyr}</code> y <code>{lubridate}</code> antes de correr este código</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-2"><a></a><span class="fu">library</span>(readxl)</span>
<span id="cb23-3"><a></a><span class="fu">library</span>(lubridate)</span>
<span id="cb23-4"><a></a>rot_berlin <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"datos/rotXLS.xlsx"</span>)</span>
<span id="cb23-5"><a></a>rot_berlin<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">month</span>(rot_berlin<span class="sc">$</span>date)</span>
<span id="cb23-6"><a></a>rot_berlin <span class="ot">&lt;-</span> rot_berlin <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a></a>  <span class="fu">group_by</span>(month, week) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a></a>  <span class="fu">summarise</span>(<span class="at">incidence =</span> <span class="fu">mean</span>(incidence),</span>
<span id="cb23-9"><a></a>            <span class="at">cases =</span> <span class="fu">round</span>(<span class="fu">mean</span>(cases),<span class="dv">0</span>),</span>
<span id="cb23-10"><a></a>            <span class="at">FM =</span> <span class="fu">mean</span>(FM),</span>
<span id="cb23-11"><a></a>            <span class="at">RSK =</span> <span class="fu">mean</span>(RSK),</span>
<span id="cb23-12"><a></a>            <span class="at">SHK_TAG =</span> <span class="fu">mean</span>(SHK_TAG),</span>
<span id="cb23-13"><a></a>            <span class="at">PM =</span> <span class="fu">mean</span>(PM),</span>
<span id="cb23-14"><a></a>            <span class="at">TMK =</span> <span class="fu">mean</span>(TMK),</span>
<span id="cb23-15"><a></a>            <span class="at">TXK =</span> <span class="fu">mean</span>(TXK),</span>
<span id="cb23-16"><a></a>            <span class="at">TNK =</span> <span class="fu">mean</span>(TNK),</span>
<span id="cb23-17"><a></a>            <span class="at">UPM =</span> <span class="fu">mean</span>(UPM))</span>
<span id="cb23-18"><a></a>rot_berlin<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(rot_berlin<span class="sc">$</span>month)</span>
<span id="cb23-19"><a></a>rot_berlin<span class="sc">$</span>week <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(rot_berlin<span class="sc">$</span>week)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelo-completo" class="slide level2 smaller">
<h2>Modelo completo</h2>
<ul>
<li>Empezaremos formulando un modelo completo para estos datos de la siguiente manera:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> FM <span class="sc">+</span> RSK <span class="sc">+</span> SHK_TAG <span class="sc">+</span> PM <span class="sc">+</span> TMK <span class="sc">+</span> TXK <span class="sc">+</span> TNK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<ul>
<li class="fragment"><p>En la función <code>lm</code> se pueden incluir términos de órdenes superiores (interacciones, cuadrados, cubos, etc) con variables continuas.</p></li>
<li class="fragment"><p>Por simplicidad, únicamente consideraremos predictores de primer orden.</p></li>
<li class="fragment"><p>Es importante tener en cuenta que así incluyésemos términos de órdenes superiores en <code>lm</code>, todavía sería considerado un modelo lineal ya que los coeficientes de estos términos seguirán siendo estimados de manera lineal (la variable de respuesta es una combinación lineal de los predictores que puede o no incluir transformaciones lineales de estos últimos).</p></li>
<li class="fragment"><p>Un ejemplo de una relación no lineal de los predictores se da cuando los coeficientes de la ecuación forman parte de expresiones no lineales:</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
y = \beta_{1}e^{\beta_2X}
\]</span></p>
</div>
</section>
<section id="selección-de-variables" class="slide level2 smaller">
<h2>Selección de variables</h2>
<div>
<ul>
<li class="fragment"><p>La selección automática de variables funciona con un algoritmo relativamente sencillo:</p>
<ul>
<li class="fragment"><p>Retira una variable a la vez del modelo, calcula un criterio de comparación y repite el proceso</p></li>
<li class="fragment"><p>Usa ese criterio de comparación con respecto a un modelo nulo (sin ningún predictor) y devuelve el modelo que haya obtenido la mejor valoración.</p></li>
</ul></li>
<li class="fragment"><p>El criterio de evaluación más usado para comparar modelos es el denominado criterio de información de Akaike (AIC), y es un estimador del error de predicción. Mientras menos sea el valor de AIC, mejores las predicciones que un modelo teoricamente será capaz de realizar.</p></li>
<li class="fragment"><p>Realizamos la selección de variables antes de cualquier diagnóstico o transformación ya que a veces estas últimas “exageran” la importancia de las variables en el caso de hacer la selección después.</p></li>
<li class="fragment"><p>La manera más sencilla de hacer una selección de variables es usando la función base de R <code>step</code></p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a><span class="fu">step</span>(lm1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="selección-de-variables-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Selección de variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">step</span>(lm1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=372.26
cases ~ FM + RSK + SHK_TAG + PM + TMK + TXK + TNK + UPM

          Df Sum of Sq   RSS    AIC
- TNK      1       2.8 15135 370.27
- RSK      1      18.7 15151 370.34
- SHK_TAG  1      42.4 15175 370.44
&lt;none&gt;                 15132 372.26
- FM       1     658.0 15790 373.03
- TMK      1     830.7 15963 373.74
- PM       1     887.1 16019 373.97
- TXK      1    1259.3 16392 375.46
- UPM      1    3660.8 18793 384.35

Step:  AIC=370.27
cases ~ FM + RSK + SHK_TAG + PM + TMK + TXK + UPM

          Df Sum of Sq   RSS    AIC
- RSK      1      17.7 15153 368.35
- SHK_TAG  1      60.8 15196 368.53
&lt;none&gt;                 15135 370.27
- FM       1     697.7 15833 371.20
- PM       1     889.7 16025 371.99
- TXK      1    1888.5 17024 375.92
- TMK      1    4107.8 19243 383.88
- UPM      1    5612.2 20747 388.78

Step:  AIC=368.35
cases ~ FM + SHK_TAG + PM + TMK + TXK + UPM

          Df Sum of Sq   RSS    AIC
- SHK_TAG  1      57.9 15211 366.60
&lt;none&gt;                 15153 368.35
- FM       1     683.9 15837 369.22
- PM       1     926.0 16079 370.21
- TXK      1    2063.6 17216 374.65
- TMK      1    4347.8 19501 382.75
- UPM      1    5962.0 21115 387.92

Step:  AIC=366.6
cases ~ FM + PM + TMK + TXK + UPM

       Df Sum of Sq   RSS    AIC
&lt;none&gt;              15211 366.60
- FM    1     698.0 15909 367.51
- PM    1    1160.5 16371 369.38
- TXK   1    2076.5 17287 372.92
- TMK   1    4423.5 19634 381.19
- UPM   1    5958.9 21169 386.09</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cases ~ FM + PM + TMK + TXK + UPM, data = rot_berlin)

Coefficients:
(Intercept)           FM           PM          TMK          TXK          UPM  
   2503.898       -7.526       -2.219      -19.360       12.304       -2.425  </code></pre>
</div>
</div>
</section>
<section id="multicolinearidad" class="slide level2 smaller">
<h2>Multicolinearidad</h2>
<ul>
<li>De acuerdo a la selección automática, nuestro modelo sería hasta el momento:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>cases <span class="sc">~</span> FM <span class="sc">+</span> PM <span class="sc">+</span> TMK <span class="sc">+</span> TXK <span class="sc">+</span> UPM</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<ul>
<li class="fragment"><p>Ningún método de selección de variables automático es perfecto.</p></li>
<li class="fragment"><p>En este caso, aunque obvio, sabemos que las variables <code>TMK</code> y <code>TXK</code> deben estar correlacionadas al ser medidas de temperatura correspondientes al mismo día.</p></li>
<li class="fragment"><p>Bien podríamos deshechar una de las dos, pero cuando no sabemos la naturaleza de las variables, es mejor llevar a cabo un análisis de correlación antes de checar el modelo por sus supuestos.</p></li>
<li class="fragment"><p>Cuando exploramos datos (módulo 4) ya hicimos una primera aproximación con las matrices de dispersión (paquete <code>{GGally}</code>. Sin embargo, en ellas solo vimos el coeficiente de correlación junto al código de significancia.</p></li>
<li class="fragment"><p>Para estar seguros de que eliminaremos variables correctamente, es mejor dar un vistazo a las matrices de correlación directamente.</p></li>
</ul>
</div>
</section>
<section id="matrices-de-correlación" class="slide level2 scrollable smaller">
<h2>Matrices de correlación</h2>
<ul>
<li>Para calcular la matriz de correlación de un conjunto de datos usaremos la librería <code>{Hmisc}</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb30-2"><a></a>matriz <span class="ot">&lt;-</span> <span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(rot_berlin[,<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>)]))</span>
<span id="cb30-3"><a></a>matriz</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       FM    PM   TMK   TXK   UPM
FM   1.00 -0.38 -0.67 -0.66  0.22
PM  -0.38  1.00  0.14  0.14 -0.02
TMK -0.67  0.14  1.00  1.00 -0.65
TXK -0.66  0.14  1.00  1.00 -0.70
UPM  0.22 -0.02 -0.65 -0.70  1.00

n= 65 


P
    FM     PM     TMK    TXK    UPM   
FM         0.0019 0.0000 0.0000 0.0824
PM  0.0019        0.2768 0.2771 0.8562
TMK 0.0000 0.2768        0.0000 0.0000
TXK 0.0000 0.2771 0.0000        0.0000
UPM 0.0824 0.8562 0.0000 0.0000       </code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>En este paso, recomiendo el mirar por fuera de la diagonal y eliminar del análisis una variable de cualquier par que tenga un coeficiente de correlación exactamente igual a 1. En este caso, eliminaré <code>TMK</code></li>
</ul>
</div>
</section>
<section id="tiene-todo-esto-sentido" class="slide level2 smaller">
<h2>¿Tiene todo esto sentido?</h2>
<ul>
<li>Hasta aquí, nuestro modelo candidato sería el siguiente</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>cases <span class="sc">~</span> FM <span class="sc">+</span> PM <span class="sc">+</span> TXK <span class="sc">+</span> UPM</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<ul>
<li class="fragment"><p>Los algoritmos usados aplican criterios estadísticos que no necesariamente denotan características biológicas.</p></li>
<li class="fragment"><p>Considerando que el rotavirus se contagia principalmente por contacto directo o indirecto con heces fecales de alguien infectado y no se ha reportado ningún caso de transmisión por aire contaminado, ¿tiene sentido mantener las variables <code>FM</code> (velocidad media diaria del viento) y <code>PM</code> (presión atmosférica media diaria) como parte del modelo?</p></li>
<li class="fragment"><p>Personalmente, pienso que no. Para mí, el modelo candidato sería el siguiente</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-múltiple" class="slide level2 smaller">
<h2>Diagnósticos de la regresión múltiple</h2>
<div>
<ul>
<li class="fragment">Una vez que tengo definido mi modelo candidato lo pondré a prueba de los supuestos:</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<ul>
<li class="fragment"><p>Vamos a introducir otra librería muy útil cuando nos encontramos ante modelos de múltiples variables: <code>{performance}</code>.</p></li>
<li class="fragment"><p><code>{performance}</code> nos ofrece la posibilidad de chequear dos diagnósticos adicionales:</p>
<ul>
<li class="fragment"><p>La predicción del modelo (basándose en una aproximación Bayesiana)</p></li>
<li class="fragment"><p>La colinearidad</p></li>
</ul></li>
<li class="fragment"><p>También se lo puede utilizar para modelos univariables (como la regresión lineal).</p></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">library</span>(performance)</span>
<span id="cb35-2"><a></a><span class="fu">check_model</span>(lm2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-múltiple-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión múltiple</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="diagnósticos-de-la-regresión-múltiple-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión múltiple</h2>
<div class="columns v-center-container">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/Rplot.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:60%;">
<p><strong>Chequeo de la predicción posterior</strong></p>
<p>Este gráfico contrapone la densidad de la distribución de la variable de respuesta con las densidades de las predicciones obtenidas del modelo mediante un proceso de sampleo Bayesiano (por eso apreciamos varias líneas azules). Nos da una idea de qué tan adecuado es nuestro modelo para predecir los valores observados. Idealmente estas dos deberían superponerse.</p>
</div></div>
</section>
<section id="diagnósticos-de-la-regresión-múltiple-3" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión múltiple</h2>
<div class="columns v-center-container">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-34-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<p><strong>Chequeo de la colinearidad</strong></p>
<p>Aquí vemos distribuidas en el eje X cada una de las variables que estamos usando como predictores mientras que en el eje Y tenemos el factor de inflación de la varianza (VIF) que cada una de estas contribuye al modelo. Nos da una idea de que variables podríamos eliminar basados en mantener únicamente variables independientes entre sí como predictores.</p>
</div></div>
</section>
<section id="transformaciones" class="slide level2 smaller">
<h2>Transformaciones</h2>
<div>
<ul>
<li class="fragment"><p>Del gráfico de la predicción posterior evidenciamos que los datos observados de incidencia de rotavirus son asimétricos hacia la izquierda (o asimetría positiva).</p></li>
<li class="fragment"><p>Usualmente la transformación que mejor funciona en este caso es el logaritmo natural.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-code-line-numbers="1|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin)</span>
<span id="cb36-2"><a></a><span class="fu">check_model</span>(lm3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="transformaciones-1" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>Transformaciones</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-37-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="removiendo-outliers" class="slide level2 smaller">
<h2>Removiendo outliers</h2>
<div>
<ul>
<li class="fragment"><p>La distancia de Cook nos ha ayudado a identificar una observación claramente influyente.</p></li>
<li class="fragment"><p>Para continuar, removeremos esa observación para ver que tanto ayuda a nuestro análisis.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>rot_berlin_out <span class="ot">&lt;-</span> rot_berlin[<span class="sc">-</span><span class="dv">22</span>, ]</span>
<span id="cb37-2"><a></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb37-3"><a></a><span class="fu">check_model</span>(lm4)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="removiendo-outliers-1" class="slide level2 smaller">
<h2>Removiendo outliers</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="modelo-final" class="slide level2 smaller scrollable">
<h2>Modelo final</h2>
<div>
<ul>
<li class="fragment">Una vez que hemos llegado a nuestro modelo, revisamos los resultados (este paso lo pudimos hacer en cada paso)</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="fu">summary</span>(lm4)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(cases + 1) ~ TXK + UPM, data = rot_berlin_out)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.56135 -0.25645 -0.01463  0.23747  0.89716 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.115325   0.785118   19.25   &lt;2e-16 ***
TXK         -0.156583   0.009426  -16.61   &lt;2e-16 ***
UPM         -0.126306   0.008891  -14.21   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4208 on 61 degrees of freedom
Multiple R-squared:  0.8241,    Adjusted R-squared:  0.8184 
F-statistic: 142.9 on 2 and 61 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</section>
<section id="interpretación" class="slide level2 smaller">
<h2>Interpretación</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(cases + 1) ~ TXK + UPM, data = rot_berlin_out)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.56135 -0.25645 -0.01463  0.23747  0.89716 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.115325   0.785118   19.25   &lt;2e-16 ***
TXK         -0.156583   0.009426  -16.61   &lt;2e-16 ***
UPM         -0.126306   0.008891  -14.21   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4208 on 61 degrees of freedom
Multiple R-squared:  0.8241,    Adjusted R-squared:  0.8184 
F-statistic: 142.9 on 2 and 61 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Por cada incremento de una unidad de <code>TXK</code>, el número de casos decrece 0.16 unidades, teniendo el resto de variables constantes.</p></li>
<li><p>Por cada incremente de una unidad de <code>UPM</code>, el número de casos decrece 0.13 unidades, teniendo el resto de variables constantes.</p></li>
<li><p>Pero ten presente que este resultado está en escala logarítmica</p></li>
</ul>
</div></div>
</section>
<section id="interpretación-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Interpretación</h2>
<ul>
<li>Haremos uso nuevamente de la librería <code>{ggeffects}</code> para lidiar con la retransformación y <code>{ggplot2}</code> junto a <code>{patchwork}</code> para graficar las predicciones.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb41-2"><a></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-3"><a></a><span class="fu">library</span>(patchwork)</span>
<span id="cb41-4"><a></a>predicciones <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(lm4)</span>
<span id="cb41-5"><a></a>predicciones[[<span class="dv">1</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of cases

TXK | Predicted |         95% CI
--------------------------------
  0 |    243.15 | 180.49, 327.44
  5 |    110.59 |  89.35, 136.83
 10 |     50.01 |  43.45,  57.53
 15 |     22.31 |  19.98,  24.90
 20 |      9.66 |   8.22,  11.32
 25 |      3.87 |   2.91,   5.07
 30 |      1.23 |   0.64,   2.03

Adjusted for:
* UPM = 76.14</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a>predicciones[[<span class="dv">2</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of cases

UPM | Predicted |         95% CI
--------------------------------
 60 |    186.40 | 137.04, 253.40
 65 |     98.65 |  78.63, 123.71
 70 |     51.99 |  44.54,  60.67
 75 |     27.18 |  24.32,  30.37
 80 |     13.99 |  12.22,  15.99
 85 |      6.97 |   5.59,   8.63
 90 |      3.24 |   2.24,   4.54
 95 |      1.25 |   0.59,   2.20

Adjusted for:
* TXK = 14.71</code></pre>
</div>
</div>
</div></div>
</section>
<section id="interpretación-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Interpretación</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a>p1 <span class="ot">&lt;-</span> predicciones[[<span class="dv">1</span>]]</span>
<span id="cb45-2"><a></a>p2 <span class="ot">&lt;-</span> predicciones[[<span class="dv">2</span>]]</span>
<span id="cb45-3"><a></a><span class="fu">plot</span>(p1) <span class="sc">+</span> <span class="fu">plot</span>(p2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<!-- ## Ejercicio 5.1 {.smaller} -->
<!-- -   Realiza un modelo de regresión lineal múltiple para los mismos datos que acabas de ver siguiendo tu propia iniciativa: -->
<!--     -   Puedes cambiar el orden de los pasos que sugerí -->
<!--     -   Realizar chequeos de la significancia de los coeficientes de los modelos candidatos entre paso y paso (cosa que yo no hice) -->
<!--     -   Puedes llevar a cabo una selección de variables manual, o cambiar el argumento `direction` de la función `step` por "forward" o "backward" -->
<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-44-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section></section>
<section>
<section id="antes-de-continuar" class="title-slide slide level1 center">
<h1>Antes de continuar</h1>

</section>
<section id="el-mágico-r2" class="slide level2">
<h2>El mágico <span class="math inline">\(R^2\)</span></h2>

<img data-src="images/vieja.jpg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="el-mágico-r2-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>El mágico <span class="math inline">\(R^2\)</span></h2>
<div>
<ul>
<li class="fragment"><p>Quizá muchos hayan escuchado que un <span class="math inline">\(R^2\)</span> cercano a 1 es “ideal” cuando realizamos una regresión lineal.</p></li>
<li class="fragment"><p>Recuerdo incluso haber sido indoctrinado acerca de márgenes para un buen <span class="math inline">\(R^2\)</span> (algo así como que por encima del 80% es “bueno”, mayor al 90% es excelente y 100% es el Nirvana).</p></li>
<li class="fragment"><p>En breve, <span class="math inline">\(R^2\)</span> <strong>NO ES NINGUNA DE LAS SIGUIENTES COSAS</strong>:</p>
<ul>
<li class="fragment"><p>Una métrica de bondad de ajuste<span class="fragment">: no nos dice si el modelo se ajusta bien a los datos.</span></p></li>
<li class="fragment"><p>Una métrica del error de predicción<span class="fragment">: no mide para nada que tan bueno es el modelo para predecir futuras observaciones.</span></p></li>
<li class="fragment"><p>Una métrica que permita comparar modelos usando variables transformadas<span class="fragment">: es común jugar a transformar los datos para ver de que manera se puede inflarlo hacia el santo grial.</span></p></li>
<li class="fragment"><p>Una métrica que permita que tan bien una variable explica otra<span class="fragment">: en el ejemplo que vimos, y en toda regresión lineal, si cambiamos el predictor por respuesta y viceversa, tendremos exactamente el mismo <span class="math inline">\(R^2\)</span></span></p></li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> es simplemente una medida de la cantidad de variación que un modelo específico explica. <span class="fragment">¿Tiene alguna utilidad práctica?</span> <span class="fragment">no lo sé, en 10 años como estadístico no lo he usado nunca, al menos no, voluntariamente…</span></p></li>
</ul>
</div>
</section>
<section id="el-mágico-r2-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>El mágico <span class="math inline">\(R^2\)</span></h2>
<div class="fragment">
<ul>
<li>Lo que visto es carnicerías de datos por inflar <span class="math inline">\(R^2\)</span> debido a esta mala interpretación que no se sabe su origen exacto (<a href="https://psycnet.apa.org/record/1946-01733-001" target="_blank">pero quizá aquí uno de tantos culpables perdidos en la historia</a>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Acá les dejo unos cuantos recursos que pueden revisar en más detalle si les interesa:</p>
<ul>
<li><p><a href="https://www.jstor.org/stable/2111095?casa_token=F0Om3ZPkjE4AAAAA%3AvR0lcSXuNHICl21EYDAoXSerVhME0AO_ZvkzayO1vYT6R3cCM9Ooy6-P9Wa6AEZN1Gcm960rjGFM9JVA4AJc4lm-nswzYJxdtiKr03H4tbVMRW16e35TlA" target="_blank">El paper “How not to lie with Statistics: Avoiding common mistakes in Quantitative Political Science”</a> Un artículo extenso pero que contiene una sección dedicada a desmitificar esta mala práctica.</p></li>
<li><p><a href="https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/10/lecture-10.pdf" target="_blank">Las notas de la clase del Prof.&nbsp;Cosma Shalizi de la Universidad Carnegie Mellon</a> donde hermosamente destruye los mitos en torno al <span class="math inline">\(R^2\)</span> citando fórmulas y principios estadísticos.</p></li>
<li><p><a href="https://data.library.virginia.edu/is-r-squared-useless/" target="_blank">Un blog de Clay Ford, consultor estadístico de la Universidad de Virginia</a> donde demuestra con R que valores de <span class="math inline">\(R^2\)</span> cercanos a 0 no necesariamente implican un mal modelo, ni valores cercanos 1 son indicativo de modelos destacados.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="el-mágico-r2-en-nuestro-ejemplo" class="slide level2 smaller" data-visibility="uncounted">
<h2>El mágico <span class="math inline">\(R^2\)</span> en nuestro ejemplo</h2>
<div>
<ul>
<li class="fragment"><p>Mediante la función <code>compare_performance</code> de la librería <code>{performance}</code>, se puede obtener un gráfico de telarañas que permite ver como el <span class="math inline">\(R^2\)</span> no sirve de nada ante modelos mejor formulados.</p></li>
<li class="fragment"><p>Ahora recordemos que al final eliminamos un outlier con el modelo que mejores diagnósticos terminamos. Para poner a todos los modelos candidatos en igualdad de condiciones, los corremos de nuevo sin ese outlier (además de utilizar una variable previamente transformada para los modelos 3 y 4, ya que <code>{performance}</code> no es capaz de retransformar por si solo)</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a></a>rot_berlin<span class="sc">$</span>cases_comp <span class="ot">&lt;-</span> rot_berlin<span class="sc">$</span>cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb46-2"><a></a>rot_berlin_out<span class="sc">$</span>cases_comp <span class="ot">&lt;-</span> rot_berlin_out<span class="sc">$</span>cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb46-3"><a></a>lm1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> FM <span class="sc">+</span> RSK <span class="sc">+</span> SHK_TAG <span class="sc">+</span> PM <span class="sc">+</span> TMK <span class="sc">+</span> TXK <span class="sc">+</span> TNK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb46-4"><a></a>lm2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb46-5"><a></a>lm3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases_comp) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb46-6"><a></a>lm4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases_comp) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb46-7"><a></a></span>
<span id="cb46-8"><a></a><span class="fu">compare_performance</span>(lm1<span class="fl">.1</span>, lm2<span class="fl">.1</span>, lm3<span class="fl">.1</span>, lm4<span class="fl">.1</span>, <span class="at">rank =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="el-mágico-r2-en-nuestro-ejemplo-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>El mágico <span class="math inline">\(R^2\)</span> en nuestro ejemplo</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>rot_berlin<span class="sc">$</span>cases_comp <span class="ot">&lt;-</span> rot_berlin<span class="sc">$</span>cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb47-2"><a></a>rot_berlin_out<span class="sc">$</span>cases_comp <span class="ot">&lt;-</span> rot_berlin_out<span class="sc">$</span>cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb47-3"><a></a>lm1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> FM <span class="sc">+</span> RSK <span class="sc">+</span> SHK_TAG <span class="sc">+</span> PM <span class="sc">+</span> TMK <span class="sc">+</span> TXK <span class="sc">+</span> TNK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb47-4"><a></a>lm2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb47-5"><a></a>lm3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases_comp) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb47-6"><a></a>lm4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(cases_comp) <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb47-7"><a></a></span>
<span id="cb47-8"><a></a><span class="fu">compare_performance</span>(lm1<span class="fl">.1</span>, lm2<span class="fl">.1</span>, lm3<span class="fl">.1</span>, lm4<span class="fl">.1</span>, <span class="at">rank =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name  | Model |    R2 | R2 (adj.) |   RMSE |  Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
------------------------------------------------------------------------------------------------------------------
lm3.1 |    lm | 0.824 |     0.818 |  0.411 |  0.421 |       0.500 |        0.500 |       0.500 |            94.93%
lm4.1 |    lm | 0.824 |     0.818 |  0.411 |  0.421 |       0.500 |        0.500 |       0.500 |            94.93%
lm1.1 |    lm | 0.847 |     0.825 | 12.989 | 14.011 |    7.53e-11 |     1.33e-11 |    1.16e-13 |            33.96%
lm2.1 |    lm | 0.759 |     0.751 | 16.341 | 16.738 |    1.26e-14 |     1.26e-14 |    1.26e-14 |             0.00%</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a><span class="fu">plot</span>(<span class="fu">compare_performance</span>(lm1<span class="fl">.1</span>, lm2<span class="fl">.1</span>, lm3<span class="fl">.1</span>, lm4<span class="fl">.1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-47-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="el-mágico-r2-en-nuestro-ejemplo-2" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>El mágico <span class="math inline">\(R^2\)</span> en nuestro ejemplo</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>El mejor modelo de acuerdo al mágico <span class="math inline">\(R^2\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a><span class="fu">check_model</span>(lm1<span class="fl">.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-48-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<ul>
<li>Nuestro pobre pero honrado mejor modelo</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">check_model</span>(lm4<span class="fl">.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-49-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="introducción-a-modelos-lineales-generalizados" class="title-slide slide level1 center">
<h1>Introducción a modelos lineales generalizados</h1>

</section>
<section id="qué-son-los-modelos-lineales-generalizados" class="slide level2 smaller">
<h2>¿Qué son los modelos lineales generalizados?</h2>
<div>
<ul>
<li class="fragment"><p>En breve, los modelos lineales generalizados son aquellos que no consideran normalmente distribuida a la variable de interés.</p></li>
<li class="fragment"><p>Toman este nombre ya que generalizan la regresión lineal al permitirle relacionarse con la variable de respuesta a través de una función de enlace que transforma a esta última a la escala normal.</p></li>
<li class="fragment"><p>Por tanto, estos modelos también compartirán los supuestos de la homogeneidad de la varianza y normalidad de los residuos. Aunque dependiendo de cada función de enlace a usarse, habrán otros estadísticos de interés.</p></li>
<li class="fragment"><p>En vista de lo basta que es la metodología dentro de este apartado de la estadística, nos enfocaremos en tan solo dos ejemplos:</p>
<ul>
<li class="fragment"><p>La regresión de Poisson</p></li>
<li class="fragment"><p>La regresión binomial negativa</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="regresión-de-poisson-en-r" class="slide level2">
<h2>Regresión de Poisson en R</h2>
<div>
<ul>
<li class="fragment"><p>En breve, la regresión de Poisson se usa para el modelado de datos discretos que representan el conteo de algún evento.</p></li>
<li class="fragment"><p>En el ejemplo que consideramos anteriormente, el número de casos de rotavirus es un ejemplo de este tipo de eventos.</p></li>
<li class="fragment"><p>La razón por la que ese modelo funcionó relativamente bien es porque inadvertidamente impusimos la función de enlace sobre los datos al aplicar la transformación logarítmica.</p></li>
<li class="fragment"><p>Veamos que sucede al implementarla en R</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a></a>glm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb52-2"><a></a><span class="fu">check_model</span>(glm1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="regresión-de-poisson-en-r-1" class="slide level2">
<h2>Regresión de Poisson en R</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-51-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="regresión-binomial-negativa" class="slide level2 smaller">
<h2>Regresión binomial negativa</h2>
<div>
<ul>
<li class="fragment"><p>Vemos que el modelo usando la regresión de Poisson no mejora mucho en términos de los supuestos.</p></li>
<li class="fragment"><p>Como mencionamos, el gráfico de sobredispersión ya nos da un indicativo de que el modelo es incorrecto.</p></li>
<li class="fragment"><p>Una alternativa para lidiar con sobredispersión es usar la regresión binomial negativa</p></li>
<li class="fragment"><p>Para ello, usaremos la librería <code>MASS</code> que ofrece esta funcionalidad</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a></a><span class="fu">library</span>(MASS)</span>
<span id="cb53-2"><a></a>glm2 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> TXK <span class="sc">+</span> UPM, <span class="at">data =</span> rot_berlin_out)</span>
<span id="cb53-3"><a></a><span class="fu">check_model</span>(glm2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="regresión-binomial-negativa-1" class="slide level2 smaller">
<h2>Regresión binomial negativa</h2>

<img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-53-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="comparación-de-modelos" class="slide level2">
<h2>Comparación de modelos</h2>
<div>
<ul>
<li class="fragment">Comparemos primero todos los modelos que hemos llevado a cabo hasta aquí sin rankearlos</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a><span class="fu">library</span>(flextable)</span>
<span id="cb54-2"><a></a><span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">compare_performance</span>(lm1<span class="fl">.1</span>, lm2<span class="fl">.1</span>, lm4<span class="fl">.1</span>, glm1, glm2)), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-84582d68{}.cl-844c3f3a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-84502ff0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-84503004{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-84505796{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-845057a0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-845057aa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-845057ab{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-845057b4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-845057b5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-84582d68"><thead><tr style="overflow-wrap:break-word;"><th class="cl-84505796"><p class="cl-84502ff0"><span class="cl-844c3f3a">Name</span></p></th><th class="cl-84505796"><p class="cl-84502ff0"><span class="cl-844c3f3a">Model</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">AIC</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">AIC_wt</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">AICc</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">AICc_wt</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">BIC</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">BIC_wt</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">RMSE</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">Sigma</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">R2_Nagelkerke</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">Score_log</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">Score_spherical</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">R2</span></p></th><th class="cl-845057a0"><p class="cl-84503004"><span class="cl-844c3f3a">R2_adjusted</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm1.1</span></p></td><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">529.825</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">533.976</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">551.414</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">12.989</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">14.011</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.847</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.825</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm2.1</span></p></td><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">547.212</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">547.890</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">555.848</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">16.341</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">16.738</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.759</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.751</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm4.1</span></p></td><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">lm</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">484.591</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.112</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">485.269</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.112</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">493.227</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.112</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.411</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.421</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.824</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.818</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">glm1</span></p></td><td class="cl-845057aa"><p class="cl-84502ff0"><span class="cl-844c3f3a">glm</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">681.463</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">681.863</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">687.939</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">17.426</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">1.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">1.000</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">-5.277</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a">0.090</span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057ab"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-845057b4"><p class="cl-84502ff0"><span class="cl-844c3f3a">glm2</span></p></td><td class="cl-845057b4"><p class="cl-84502ff0"><span class="cl-844c3f3a">negbin</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">480.440</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">0.888</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">481.118</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">0.888</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">489.076</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">0.888</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">20.876</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">1.000</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">0.995</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">-3.845</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a">0.101</span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td><td class="cl-845057b5"><p class="cl-84503004"><span class="cl-844c3f3a"></span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="comparación-de-modelos-1" class="slide level2" data-visibility="uncounted">
<h2>Comparación de modelos</h2>
<div>
<ul>
<li class="fragment">Ahora rankeados</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a></a><span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">compare_performance</span>(lm1<span class="fl">.1</span>, lm2<span class="fl">.1</span>, lm4<span class="fl">.1</span>, glm1, glm2, <span class="at">rank =</span> T)), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-84e193a0{}.cl-84d82f04{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-84dba332{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-84dba346{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-84dbbf70{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-84dbbf7a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-84dbbf7b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-84dbbf7c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-84dbbf84{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-84dbbf85{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-84e193a0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-84dbbf70"><p class="cl-84dba332"><span class="cl-84d82f04">Name</span></p></th><th class="cl-84dbbf70"><p class="cl-84dba332"><span class="cl-84d82f04">Model</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">RMSE</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">Sigma</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">R2_Nagelkerke</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">Score_log</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">Score_spherical</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">R2</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">R2_adjusted</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">AIC_wt</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">AICc_wt</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">BIC_wt</span></p></th><th class="cl-84dbbf7a"><p class="cl-84dba346"><span class="cl-84d82f04">Performance_Score</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">glm2</span></p></td><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">negbin</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">20.876</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">1.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.995</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">-3.845</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.101</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.888</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.888</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.888</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.793</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">lm4.1</span></p></td><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">lm</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.411</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.421</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.824</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.818</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.112</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.112</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.112</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.475</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">glm1</span></p></td><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">glm</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">17.426</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">1.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">1.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">-5.277</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.090</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.227</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">lm1.1</span></p></td><td class="cl-84dbbf7b"><p class="cl-84dba332"><span class="cl-84d82f04">lm</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">12.989</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">14.011</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.847</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.825</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf7c"><p class="cl-84dba346"><span class="cl-84d82f04">0.111</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-84dbbf84"><p class="cl-84dba332"><span class="cl-84d82f04">lm2.1</span></p></td><td class="cl-84dbbf84"><p class="cl-84dba332"><span class="cl-84d82f04">lm</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">16.341</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">16.738</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04"></span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.759</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.751</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.000</span></p></td><td class="cl-84dbbf85"><p class="cl-84dba346"><span class="cl-84d82f04">0.044</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="consideraciones-sobre-la-comparación-de-modelos" class="slide level2" data-visibility="uncounted">
<h2>Consideraciones sobre la comparación de modelos</h2>
<div>
<ul>
<li class="fragment"><p>La versatilidad de <code>{performance}</code> es que nos permite comparar entre modelos provenientes de distintas metodologías estadísticas (hace no más de 5 años eso no era posible).</p></li>
<li class="fragment"><p>Sin embargo, hay que tener en cuenta que para que las comparaciones sean válidas, los modelos tienen que haber sido ajustados sobre los mismos datos.</p></li>
<li class="fragment"><p>Por ejemplo, no hubiese sido correcto en este ejemplo comparar todos los modelos que llevamos a cabo sin que estos hubiesen sido ajustados sobre la tabla de datos sin el outlier.</p></li>
</ul>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:37.5%;">

</div><div class="column" style="width:60%;">
<div class="title" data-id="title">
<p><a href="https://mmorenozam.github.io/biohack-website/ejercicios_m7.html#ejercicios-7.1" target="_blank">Ejercicios 7.1</a></p>
</div>
                    <div id="Timer1"></div>
                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            initializeTimer("Timer1", 900, "interaction");
                        });
                    </script>
                
</div></div>

<img data-src="images/catxie.png" class="image-left r-stretch"></section></section>
<section>
<section id="análisis-de-componentes-principales" class="title-slide slide level1 center">
<h1>Análisis de Componentes Principales</h1>

</section>
<section id="introducción" class="slide level2 smaller">
<h2>Introducción</h2>
<div>
<ul>
<li class="fragment"><p>Llamado también PCA (por sus siglas en Inglés), es un método <strong>estadístico</strong> multivariado que tiene por objetivo el reducir las dimensiones de un conjunto de datos.</p></li>
<li class="fragment"><p>Mediante esta reducción, se pueden simplificar y visualizar datos altamente complejos. Esto ayuda a la interpretación e identificación de procesos que de otra forma, no sería fácil el determinar.</p></li>
<li class="fragment"><p>Es por esta razón que el PCA (ó APC) es popular en biología al ser este un campo donde comúnmente se generan datos que pueden contener cientos de filas y columnas.</p></li>
<li class="fragment"><p>Las preguntas que se pueden contestar con APC incluyen:</p>
<ul>
<li class="fragment"><p>¿Qué muestras son más o menos similares entre sí?</p></li>
<li class="fragment"><p>¿Qué variables independientes se comportan de manera similar?</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="introducción-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Introducción</h2>
<ul>
<li>El ACP encuentra la dirección de la máxima varianza en espacios multidimensionales a través de transformaciones lineales a un nuevo sistema coordenado.</li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/pca1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="fragment">
<div>
<ul>
<li class="fragment"><p>Este nuevo sistema coordenado está conformado por los llamados Componentes Principales (CP).</p></li>
<li class="fragment"><p>Existen tantos CP como variables (dimensiones) tengan nuestros datos.</p></li>
<li class="fragment"><p>Cada componente es un una combinación lineal de las variables originales y buscan explicar la mayor cantidad de varianza posible. Por ello, es práctica común reportar solo los dos primeros CP</p></li>
</ul>
</div>
</div>
</section>
<section id="introducción-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Introducción</h2>

<img data-src="images/pca1.png" class="quarto-figure quarto-figure-center r-stretch"><div>
<ul>
<li class="fragment"><p>Las contribuciones de cada variable en el eje del CP están indicadas por una flecha (carga).</p></li>
<li class="fragment"><p>Estas cargas reflejan la correlación entre la variable y el CP.</p></li>
<li class="fragment"><p>Mientras más larga es la carga, mayor la correlación. Indicando que la variable es más importante en explicar/controlar la diferencia entre las muestras a lo largo del CP.</p></li>
<li class="fragment"><p>En el gráfico, <span class="math inline">\(CO_3\)</span> y pH son por tanto las variables más importantes del CP1, y <span class="math inline">\(Ca^{2+}\)</span> y Salinity del CP2</p></li>
</ul>
</div>
</section>
<section id="consideraciones-antes-de-implementar-apc" class="slide level2 smaller">
<h2>Consideraciones antes de implementar APC</h2>
<div>
<ul>
<li class="fragment"><p>El input de un APC pueden ser dos o más variables continuas. El APC clásico no puede lidiar con variables categóricas.</p></li>
<li class="fragment"><p>Debido a las posibles diferencias en los órdenes de magnitud y varianzas entre las variables continuas objeto de estudio, es aconsejable el estandarizar los valores.</p></li>
<li class="fragment"><p>Estandarizar un valor es convertirlo a una distribución normal con media cero y desviación estándar 1. <span class="fragment">R se encarga de este paso por nosotros.</span></p></li>
<li class="fragment"><p>Los datos para un PCA no necesariamente tienen que cumplir los supuestos de normalidad y homogeneidad de las varianzas, así tampoco necesitan ser totalmente independientes.</p></li>
<li class="fragment"><p>Los principales resultados del APC son dos: <strong>gráfico de puntuaciones</strong> y el <strong>gráfico de cargas</strong></p></li>
</ul>
</div>
</section>
<section id="qué-no-hace-el-apc" class="slide level2 smaller">
<h2>¿Qué NO hace el APC?</h2>
<div>
<p>El APC no es un método estadístico dirigido a llevar pruebas de hipótesis o estadística inferencial. En más detalle:</p>
<ol type="1">
<li class="fragment"><p><strong>No valores p o pruebas de hipótesis:</strong> no provee valores p, intervalos de confianza o signficancia estadística como podemos esperar del ANOVA. Sirve para explicar varianza y encontrar patrones en los datos.</p></li>
<li class="fragment"><p><strong>No es un modelo predictivo:</strong> no intenta predecir una variable dependiente en función de un set de variables independientes.</p></li>
<li class="fragment"><p><strong>No tiene definición entre variables dependientes y explanatorias:</strong> trata a todas las variables de input por igual.</p></li>
<li class="fragment"><p><strong>No provee interpretabilidad directa sobre las variables de input:</strong> al convertir las variables originales a un nuevo eje coordenado de componentes principales, no ofrece interpretaciones cuantitativas de las variables que forman parte de las combinaciones lineales que dieron lugar a los componentes principales.</p></li>
</ol>
</div>
</section>
<section id="apc-en-r" class="slide level2">
<h2>APC en R</h2>
<p>Usaremos una tabla de datos <code>overdose.csv</code> que contiene información del número de muertes por sobredosis de drogas sintéticas, heroína, metadona y causas naturales en 33 estados de los Estados Unidos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a>git_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/mmorenozam/biohack-modulo7/refs/heads/main/overdose.csv"</span></span>
<span id="cb56-2"><a></a></span>
<span id="cb56-3"><a></a>overdose <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(git_url)</span>
<span id="cb56-4"><a></a></span>
<span id="cb56-5"><a></a><span class="fu">head</span>(overdose)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    State year Heroin Methadone Natural Synthetic abb region
1 Arizona 2010     90       106     327        68  AZ   West
2 Arizona 2011    117        55     313        40  AZ   West
3 Arizona 2012    101        50     326        36  AZ   West
4 Arizona 2013    146        64     253        52  AZ   West
5 Arizona 2014    197        62     290        57  AZ   West
6 Arizona 2015    247        75     298        72  AZ   West</code></pre>
</div>
</div>
</section>
<section id="apc-en-r-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>APC en R</h2>
<p>Nos ayudaremos de la librería <code>{ggbiplot}</code> y la función R de base <code>prcomp</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-2"><a></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb58-3"><a></a></span>
<span id="cb58-4"><a></a>overdose.pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(overdose[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">scale.=</span>T)</span>
<span id="cb58-5"><a></a></span>
<span id="cb58-6"><a></a><span class="fu">ggbiplot</span>(overdose.pc, </span>
<span id="cb58-7"><a></a>         <span class="at">groups =</span> overdose<span class="sc">$</span>region,</span>
<span id="cb58-8"><a></a>         <span class="at">labels =</span> overdose<span class="sc">$</span>abb,</span>
<span id="cb58-9"><a></a>         <span class="at">ellipse =</span> T) <span class="sc">+</span> </span>
<span id="cb58-10"><a></a>  <span class="fu">coord_cartesian</span>() <span class="sc">+</span></span>
<span id="cb58-11"><a></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:&quot;50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-58-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="apc-en-r-2" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>APC en R</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>CP1: explica 63.5% de la varianza, representando en general las razones de muerte registradas, Nueva York (NY) al límite superior, y el resto de estados al límite inferior.</p></li>
<li><p>CP2: explica 28.2% de la varianza, representando un contraste entre las muertes causadas por heroína y drogas sintéticas con respecto a las muertes de causas naturales y metadona. En este componente, los estados de Ohio (OH) y la Florida (FL) se encuentran opuestos.</p></li>
<li><p>Las regiones son representadas por las diferencias en las causas de muerte registradas: en el medio oeste (Midwest) y noreste (Northeast), las drogas sintéticas y heroína producen mayores incidencias que con respecto a las regiones sur (South) y oeste (west) donde muestran más incidencias las muertes por causas naturales y metadona.</p></li>
<li><p>Los ángulos de las cargas, al ser evidentemente menores a 90<span class="math inline">\(^o\)</span> denotan que las causas de muerte en la tabla de datos original están correlacionadas.</p></li>
</ul>
</div><div class="column" style="width:&quot;50%;">
<p><br> <br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="biohack-modulo7_files/figure-revealjs/unnamed-chunk-59-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:37.5%;">

</div><div class="column" style="width:60%;">
<div class="title" data-id="title">
<p><a href="https://mmorenozam.github.io/biohack-website/ejercicios_m7.html#ejercicios-7.2" target="_blank">Ejercicios 7.2</a></p>
</div>
                    <div id="Timer2"></div>
                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            initializeTimer("Timer2", 600, "interaction");
                        });
                    </script>
                
</div></div>

<img data-src="images/timo-volz-ZlFKIG6dApg-unsplash.jpg" class="image-left r-stretch"></section>
<section id="section-3" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="title" data-id="title">
<p>Fin del módulo 7</p>
</div>
<div class="callout callout-tip callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Créditos de fotos</strong></p>
</div>
<div class="callout-content">
<p>Foto portada por <a href="https://unsplash.com/@nathanareboucas?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Nathana Rebouças</a> en <a href="https://unsplash.com/photos/a-person-holding-a-calculator-in-their-hand-AGLTICzftCc?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p>
<p>Foto en Ejercicio 7.2 por <a href="https://unsplash.com/@magict1911?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Timo Volz</a> en <a href="https://unsplash.com/photos/orange-cat-stretching-on-white-surface-ZlFKIG6dApg?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p>
<p>Foto final por <a href="https://unsplash.com/@furkanelveren?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Furkan Elveren</a> en <a href="https://unsplash.com/photos/a-hand-reaching-up-into-the-air-above-a-field-of-grass-20P5tXZFjEc?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p>
<p>Resto de fotos: Varias fuentes</p>
</div>
</div>
</div>
</div><div class="column" style="width:37.5%;">
<p><img data-src="images/icon1_nb.png" style="margin-left:120px"></p>
</div></div>
<p><img data-src="images/furkan-elveren-20P5tXZFjEc-unsplash.jpg" class="image-right"></p>

<div class="quarto-auto-generated-content">
<p><img src="images/icon1_nb.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"theme":"whiteboard","boardmarkerWidth":4},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: false,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1400,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script>
    // Copy over background colors to new div
    divs = document.querySelectorAll('[data-background-color]');

    Array.from(divs).map(function (x) {
      const color = x.dataset.backgroundColor;

      var new_div = document.createElement('div');
      new_div.setAttribute("class", "background-color-div");
      new_div.style.backgroundColor = color;
      x.appendChild(new_div);
      x.removeAttribute("data-background-color");
    })

    // Remove background colors from backgrounds div
    Array.from(
      document.querySelectorAll("[data-background-hash]")
    ).map(function (x) {
      x.removeAttribute("data-background-hash");
      x.style.backgroundColor = null;
    })
    </script>

    <script>
    // Copy over background images to new div
    divs = document.querySelectorAll('[data-background-image]');

    Array.from(divs).map(function (x) {
      var new_div = document.createElement('div');
      new_div.setAttribute("class", "background-image-div");

      if (x.dataset.backgroundImage != undefined) {
        new_div.style.backgroundImage = "url(" + x.dataset.backgroundImage + ")";
        x.removeAttribute("data-background-image");
      }
      if (x.dataset.backgroundSize != undefined) {
        new_div.style.backgroundSize = x.dataset.backgroundSize;
        x.removeAttribute("data-background-size");
      }
      if (x.dataset.backgroundPosition != undefined) {
        new_div.style.backgroundPosition = x.dataset.backgroundPosition;
        x.removeAttribute("data-background-position");
      }
      if (x.dataset.backgroundRepeat != undefined) {
        new_div.style.backgroundRepeat = x.dataset.backgroundRepeat;
        x.removeAttribute("data-background-repeat");
      }
      if (x.dataset.backgroundOpacity != undefined) {
        new_div.style.backgroundOpacity = x.dataset.backgroundOpacity;
        x.removeAttribute("data-background-opacity");
      }

      x.appendChild(new_div);
    })
    </script>

    <script>
    // Copy over background vidoes

    // Run once when we load
    var video_div = document.querySelectorAll(".backgrounds video");
    var slide_div = document.querySelectorAll("[data-background-video]");

    for (let i = 0; i < video_div.length; i++) {
      video_div[i].setAttribute("class", "background-video-div");

      slide_div[i].appendChild(video_div[i]);
      slide_div[i].removeAttribute("data-background-video");
    }

    Reveal.getCurrentSlide().querySelectorAll("video").forEach(x => x.play());

    // Each time we advance slides, as the background videos aren't loaded
    // unless they are a few slides away
    Reveal.on('slidechanged', event => {
      var video_div = document.querySelectorAll(".backgrounds video");
      var slide_div = document.querySelectorAll("[data-background-video]");

      for (let i = 0; i < video_div.length; i++) {
        video_div[i].setAttribute("class", "background-video-div");

        slide_div[i].appendChild(video_div[i]);
        slide_div[i].removeAttribute("data-background-video");
      }

      Reveal.getCurrentSlide().querySelectorAll("video").forEach(x => x.play());
    });
    </script>

    <script>
    // Copy over background vidoes

    // Run once when we load
    var iframe_div = document.querySelectorAll(".backgrounds iframe");
    var slide_div = document.querySelectorAll("[data-background-iframe]");

    for (let i = 0; i < iframe_div.length; i++) {
      iframe_div[i].setAttribute("class", "background-iframe-div");

      slide_div[i].appendChild(iframe_div[i]);
      slide_div[i].removeAttribute("data-background-iframe");
    }

    // Each time we advance slides, as the background videos aren't loaded
    // unless they are a few slides away
    Reveal.on('slidechanged', event => {
      var iframe_div = document.querySelectorAll(".backgrounds iframe");
      var slide_div = document.querySelectorAll("[data-background-iframe]");

      for (let i = 0; i < iframe_div.length; i++) {
        iframe_div[i].setAttribute("class", "background-iframe-div");

        slide_div[i].appendChild(iframe_div[i]);
        slide_div[i].removeAttribute("data-background-iframe");
      }
    });
    </script>

    <script>
    // Clean up slide background styles
    divs = document.querySelectorAll('.slide-background-content');
    Array.from(divs).map(function (x) {
      x.style = null;
    })
    </script>

    <script>
    // Move menu button
    menu_div = document.querySelector(".slide-menu-button");
    document.querySelector(".slides").appendChild(menu_div);

    // Move progress bar
    menu_div = document.querySelector(".progress");
    document.querySelector(".slides").appendChild(menu_div);
    </script>

    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>